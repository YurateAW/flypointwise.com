<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FlyPointWise Agent</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
<h1>FlyPointWise Flight Optimizer ✈️</h1>
<form id="searchForm">
  <input id="from" placeholder="From (IATA)" required>
  <input id="to" placeholder="To (IATA)" required>
  <input id="departure" type="date" required>
  <input id="return" type="date">
  <input id="passengers" type="number" value="1" min="1">
  <select id="travelClass">
    <option value="ECONOMY">Economy</option>
    <option value="BUSINESS">Business</option>
    <option value="BOTH">Compare Both</option>
  </select>
  <button type="submit">Search</button>
</form>
<div id="results" class="results"></div>
</div>
<script>
document.getElementById('searchForm').addEventListener('submit', async e => {
  e.preventDefault();
  const query = { from: from.value, to: to.value, departure: departure.value, return: return.value, passengers: passengers.value, travelClass: travelClass.value };
  const resultsDiv = document.getElementById('results');
  resultsDiv.innerHTML = '<p>Searching...</p>';
  const response = await fetch('https://flypointwise-production.up.railway.app/api/flight-agent', {
    method: 'POST', headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(query)
  });
  const data = await response.json();
  if (!Array.isArray(data)) return resultsDiv.innerHTML = '<p>No results.</p>';
  resultsDiv.innerHTML = data.map(f => \`
    <div class="card">
      <h2>\${f.airline}</h2>
      <p><strong>Route:</strong> \${f.route}</p>
      <p><strong>Cabin:</strong> \${f.cabin}</p>
      <p><strong>Cash Price:</strong> €\${f.cash_price}</p>
      <p><strong>Best Program:</strong> \${f.best_program.name} (\${f.best_program.ratio})</p>
      <p><strong>Required Points:</strong> \${f.best_program.required_points.toLocaleString()} + €\${f.best_program.taxes} taxes</p>
      <p><em>\${f.recommendation}</em></p>
    </div>\`).join('');
});
</script>
</body>
</html>
